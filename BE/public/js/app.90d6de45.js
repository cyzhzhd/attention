(function(e){function t(t){for(var s,i,r=t[0],l=t[1],c=t[2],u=0,m=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&m.push(n[i][0]),n[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);d&&d(t);while(m.length)m.shift()();return a.push.apply(a,c||[]),o()}function o(){for(var e,t=0;t<a.length;t++){for(var o=a[t],s=!0,i=1;i<o.length;i++){var l=o[i];0!==n[l]&&(s=!1)}s&&(a.splice(t--,1),e=r(r.s=o[0]))}return e}var s={},n={app:0},a=[];function i(e){return r.p+"js/"+({about:"about"}[e]||e)+"."+{about:"e6fa2702"}[e]+".js"}function r(t){if(s[t])return s[t].exports;var o=s[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.e=function(e){var t=[],o=n[e];if(0!==o)if(o)t.push(o[2]);else{var s=new Promise((function(t,s){o=n[e]=[t,s]}));t.push(o[2]=s);var a,l=document.createElement("script");l.charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.src=i(e);var c=new Error;a=function(t){l.onerror=l.onload=null,clearTimeout(u);var o=n[e];if(0!==o){if(o){var s=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+s+": "+a+")",c.name="ChunkLoadError",c.type=s,c.request=a,o[1](c)}n[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:l})}),12e4);l.onerror=l.onload=a,document.head.appendChild(l)}return Promise.all(t)},r.m=e,r.c=s,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(o,s,function(t){return e[t]}.bind(null,s));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var d=c;a.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"0419":function(e,t,o){"use strict";var s=o("ae1e"),n=o.n(s);n.a},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},"1f53":function(e,t,o){e.exports=o.p+"img/cat.b69e7707.png"},2:function(e,t){},"20fc":function(e,t,o){},"2c86":function(e,t,o){},3:function(e,t){},"322e":function(e,t,o){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,o){"use strict";o.r(t);o("d3b7"),o("25f0"),o("e260"),o("e6cf"),o("cca6"),o("a79d");var s=o("2b0e"),n=o("bc3a"),a=o.n(n),i=o("3452"),r=o.n(i),l=o("59ca"),c=(o("000b"),o("ea7b"),o("66ce"),o("e71f"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app"},[o("div",{staticClass:"nav"},[o("router-link",{staticClass:"router",attrs:{to:"/"}},[e._v("Home")]),o("router-link",{staticClass:"router",attrs:{to:"/about"}},[e._v("About")])],1),o("router-view",{staticClass:"router-view"})],1)}),u=[],d=(o("5c0b"),o("2877")),m={},f=Object(d["a"])(m,c,u,!1,null,null,null),p=f.exports,h=o("8c4f"),v=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"login-page"},[o("nav",{staticClass:"login-signup"},[o("ul",{staticClass:"menu"},[o("li",{staticClass:"menu-item",on:{click:function(t){return t.preventDefault(),e.activeLogIn(t)}}},[o("a",{staticClass:"menu-link",attrs:{href:"#"}},[e._v("Log In")])]),o("li",{staticClass:"menu-item",on:{click:function(t){return t.preventDefault(),e.activeSignUp(t)}}},[o("a",{staticClass:"menu-link",attrs:{href:"#"}},[e._v("Sign Up")])])])]),e.hasLogInActivated?o("div",{staticClass:"login-form"},[o("h2",[e._v("Login")]),o("form",{staticClass:"login-form",on:{submit:function(t){return t.preventDefault(),e.LogIn(e.login.email,e.login.password)}}},[o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.login.email,expression:"login.email",modifiers:{trim:!0}}],staticClass:"login-email",attrs:{type:"email",placeholder:"Enter your email address"},domProps:{value:e.login.email},on:{input:function(t){t.target.composing||e.$set(e.login,"email",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.login.password,expression:"login.password",modifiers:{trim:!0}}],staticClass:"login-password",attrs:{type:"password",placeholder:"password"},domProps:{value:e.login.password},on:{input:function(t){t.target.composing||e.$set(e.login,"password",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("button",{attrs:{type:"submit",variant:"primary",disabled:!e.login.email}},[e._v("Login")])])]):o("div",{staticClass:"signup-form"},[o("h2",[e._v("Sign Up")]),o("form",{staticClass:"signup-form",on:{submit:function(t){return t.preventDefault(),e.SignUp()}}},[o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.signup.email,expression:"signup.email",modifiers:{trim:!0}}],staticClass:"signup-email",attrs:{type:"email",placeholder:"Enter your email address"},domProps:{value:e.signup.email},on:{input:function(t){t.target.composing||e.$set(e.signup,"email",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.signup.password,expression:"signup.password",modifiers:{trim:!0}}],staticClass:"signup-password",attrs:{type:"password",placeholder:"password"},domProps:{value:e.signup.password},on:{input:function(t){t.target.composing||e.$set(e.signup,"password",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.signup.displayName,expression:"signup.displayName",modifiers:{trim:!0}}],staticClass:"signup-displayname",attrs:{type:"text",placeholder:"displayname"},domProps:{value:e.signup.displayName},on:{input:function(t){t.target.composing||e.$set(e.signup,"displayName",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("button",{attrs:{type:"submit",variant:"primary",disabled:!e.signup.email}},[e._v("Sign Up")])])]),o("p",{staticClass:"error-message"},[e._v(e._s(e.errorMessage))])])},g=[],C={name:"loginPage",data:function(){return{login:{email:"",password:""},signup:{email:"",password:"",displayName:""},errorMessage:"",hasLogInActivated:!0}},methods:{LogIn:function(){var e=this;this.$auth.signInWithEmailAndPassword(this.login.email,this.login.password).then((function(t){e.$setUser(t.user),e.login.email="",e.login.password="",e.$router.push({name:"RoomList"})})).catch((function(t){e.errorMessage="잘못된 아이디 혹은 비밀번호를 입력하셨습니다.",console.log(t)}))},SignUp:function(){var e=this,t={email:this.signup.email,password:this.signup.password,displayName:this.signup.displayName};this.$http.post("/api/firebase/signup",t).then((function(t){"auth/invalid-password"===t.data.code?e.errorMessage="비밀번호는 6자리 이상 입력해주세요":"auth/invalid-email"===t.data.code?e.errorMessage="정확한 이메일 주소를 입력해주세요.":(console.log(t),e.login.email=e.signup.email,e.signup.email="",e.signup.password="",e.signup.displayName="",e.errorMessage="",e.hasLogInActivated=!0)})).catch((function(e){console.log(e)}))},activeLogIn:function(){this.errorMessage="",this.hasLogInActivated=!0},activeSignUp:function(){this.errorMessage="",this.hasLogInActivated=!1}}},b=C,_=(o("d6db"),Object(d["a"])(b,v,g,!1,null,null,null)),I=_.exports,w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page"},[s("header",{staticClass:"header1"},[s("h2",{staticClass:"category"},[e._v("Room List")]),s("router-link",{staticClass:"add-room",attrs:{to:{name:"AddRoom"},action:""}},[e._v("Add room")])],1),e._m(0),s("section",{staticClass:"room"},[s("ul",{staticClass:"room-list"},e._l(e.rooms,(function(t){return s("li",{key:t.roomId,staticClass:"room-item"},[s("p",{staticClass:"room-settings",on:{click:[function(o){return o.preventDefault(),e.$refs.menu.open(o,{roomId:t.roomId,roomName:t.roomName,host:t.host})},function(e){e.stopPropagation()}]}},[s("i",{staticClass:"fa fa-ellipsis-h",attrs:{"aria-hidden":"true"}})]),s("router-link",{staticClass:"room-name",attrs:{to:{name:"Room",params:{roomId:t.roomId,roomName:t.roomName}},action:""}},[s("figure",{staticClass:"room-image",style:{backgroundImage:"url("+o("1f53")+")"}}),e._v(" "+e._s(t.roomName)+" ")])],1)})),0)]),e._m(1),s("vue-context",{ref:"menu",scopedSlots:e._u([{key:"default",fn:function(t){return[s("li",[s("a",{on:{click:function(o){return o.preventDefault(),e.manageTeam(t.data)}}},[e._v("팀 관리")])]),s("li",[s("a",{on:{click:function(o){return o.preventDefault(),e.leaveTeam(t.data)}}},[e._v("팀 나가기")])]),s("li",[s("a",{on:{click:function(o){return o.preventDefault(),e.deleteTeam(t.data)}}},[e._v("팀 삭제")])])]}}])}),s("handoverModal",{attrs:{showModal:e.modalList.showingHandOverModal,roomId:e.roomId},on:{closemodal:function(t){return e.closeModal("showingHandOverModal")}}}),s("div",{staticClass:"modal-wrapper",on:{click:function(t){return e.closeModal("showingConfirmModal")}}},[e.modalList.showingConfirmModal?s("smallModal",{on:{close:e.modalList.showingConfirmModal}},[s("h3",{attrs:{slot:"header"},slot:"header"},[e._v(" 방을 삭제하려면 '확인'을 입력해주세요 ")]),s("h4",{attrs:{slot:"body"},slot:"body"},[s("form",{on:{submit:function(t){return t.preventDefault(),e.confirm(t)}}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.textConfirm,expression:"textConfirm",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"확인"},domProps:{value:e.textConfirm},on:{input:function(t){t.target.composing||(e.textConfirm=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),s("button",{attrs:{type:"submit",variant:"primary",disabled:!e.confirm}},[e._v(" 확인 ")])])]),s("h6",{attrs:{slot:"footer"},slot:"footer"},[e._v(" 이 행동은 되돌릴 수 없습니다. "),s("i",{staticClass:"fa fa-times closeModalBtn fa-2x",attrs:{"aria-hidden":"true"},on:{click:function(t){return e.closeModal("showingConfirmModal")}}})])]):e._e()],1)],1)},y=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("header",{staticClass:"header2"},[o("h2",{staticClass:"notice-header"},[e._v("공지사항")])])},function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("section",{staticClass:"notice"},[o("div",{staticClass:"contents"},[o("ul",{staticClass:"content-list"},[o("li",{staticClass:"content-item"},[e._v(" 수학 "),o("p",[e._v(" 1. 숙제해오기 "),o("br"),e._v("2. 3번 풀어오기 ")])]),o("li",{staticClass:"content-item"},[e._v(" 영어 "),o("p",[e._v(" 1. 2단원 지문 3번 읽기 "),o("br"),e._v("2. 3단원 듣기테스트 2개 듣기 "),o("br"),e._v("3. 3단원 단어 30문제 테스트 ")])])])])])}],M=(o("4160"),o("159b"),o("899b")),k=(o("f89b"),function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"modal"},[o("div",{staticClass:"modal-wrapper",on:{click:e.closeModal}},[e.showModal?o("mediumModal",{on:{close:e.showModal}},[o("h3",{attrs:{slot:"header"},on:{click:e.showUserList},slot:"header"},[e._v(" 유저 목록 보기 "),o("i",{staticClass:"fa fa-users",attrs:{"aria-hidden":"true"}})]),o("h4",{attrs:{slot:"body"},slot:"body"},e._l(e.userlist,(function(t){return o("li",{key:t.uid},[1===e.userlist.length?o("div",[e._v(" 팀에 혼자 남아 있습니다. 팀을 나가려면 팀 삭제를 눌러주세요. ")]):o("div",[t.uid!==e.$user.uid?o("a",{on:{click:function(o){return e.chooseUser(t)}}},[e._v(e._s(t.userName))]):e._e()])])})),0),o("h6",{attrs:{slot:"footer"},slot:"footer"},[e._v(" 팀을 나가려면 다른 유저에게 팀장을 양도해주세요. "),o("i",{staticClass:"fa fa-times closeModalBtn fa-2x",attrs:{"aria-hidden":"true"},on:{click:e.closeModal}})])]):e._e()],1),o("div",{staticClass:"modal-wrapper",on:{click:e.closeModal}},[e.showingConfirmModal?o("smallModal",{on:{close:e.showingConfirmModal}},[o("h3",{attrs:{slot:"header"},slot:"header"},[e._v(" 팀장을 양도하려면 '확인'을 입력해주세요 ")]),o("h4",{attrs:{slot:"body"},slot:"body"},[o("form",{on:{submit:function(t){return t.preventDefault(),e.confirm(t)}}},[o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.textConfirm,expression:"textConfirm",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"확인"},domProps:{value:e.textConfirm},on:{input:function(t){t.target.composing||(e.textConfirm=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("button",{attrs:{type:"submit",variant:"primary",disabled:!e.confirm}},[e._v(" 확인 ")])])]),o("h6",{attrs:{slot:"footer"},slot:"footer"},[e._v(" 이 행동은 되돌릴 수 없습니다. "),o("i",{staticClass:"fa fa-times closeModalBtn fa-2x",attrs:{"aria-hidden":"true"},on:{click:e.closeConfirmModal}})])]):e._e()],1)])}),$=[],x=(o("96cf"),o("1da1")),N=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition",{attrs:{name:"modal"}},[o("div",{staticClass:"modal-mask"},[o("div",{staticClass:"modal-wrapper"},[o("div",{staticClass:"modal-container",on:{click:function(e){e.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[e._t("header",[e._v(" default header ")])],2),o("div",{staticClass:"modal-body"},[e._t("body",[e._v(" default body ")])],2),o("div",{staticClass:"modal-footer"},[e._t("footer",[e._v("default footer")])],2)])])])])},U=[],R={},T=R,O=(o("d176"),Object(d["a"])(T,N,U,!1,null,null,null)),L=O.exports,E=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("transition",{attrs:{name:"modal"}},[o("div",{staticClass:"modal-mask"},[o("div",{staticClass:"modal-wrapper"},[o("div",{staticClass:"modal-container",on:{click:function(e){e.stopPropagation()}}},[o("div",{staticClass:"modal-header"},[e._t("header",[e._v(" default header ")])],2),o("div",{staticClass:"modal-body"},[e._t("body",[e._v(" default body ")])],2),o("div",{staticClass:"modal-footer"},[e._t("footer",[e._v("default footer")])],2)])])])])},S=[],j={},A=j,D=(o("0419"),Object(d["a"])(A,E,S,!1,null,null,null)),V=D.exports,P={components:{mediumModal:L,smallModal:V},props:["showModal","roomId"],data:function(){return{userlist:[],chosenUser:"",textConfirm:"",showingConfirmModal:!1}},methods:{closeModal:function(){this.$emit("closemodal"),this.userlist=[],this.showingConfirmModal=!1,this.textConfirm=""},closeConfirmModal:function(){this.showingConfirmModal=!1,this.textConfirm=""},chooseUser:function(e){this.chosenUser=e,this.showingConfirmModal=!this.showingConfirmModal},confirm:function(){var e=this;return Object(x["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("확인"!==e.textConfirm){t.next=8;break}return e.$emit("closemodal"),e.closeConfirmModal(),t.next=5,e.leaveTeam();case 5:e.delegateHost(),t.next=9;break;case 8:console.log("try it again");case 9:case"end":return t.stop()}}),t)})))()},delegateHost:function(){var e={roomId:this.roomId,uid:this.chosenUser.uid,userName:this.chosenUser.userName};this.$http.post("api/firebase/delegateHost",e)},leaveTeam:function(){var e={roomId:this.roomId,uid:this.$user.uid};this.$http.post("/api/firebase/leaveTeam",e)},showUserList:function(){var e=this;this.$firebase.database().ref("/rooms/".concat(this.roomId,"/userlist")).on("value",(function(t){e.userlist=[],t.forEach((function(t){var o=t.val();e.userlist.push(o)}))}))}}},W=P,H=Object(d["a"])(W,k,$,!1,null,null,null),B=H.exports,F={name:"roomList",components:{VueContext:M["a"],handoverModal:B,smallModal:V},data:function(){return{uid:this.$user.uid,modalList:{showingHandOverModal:!1,showingConfirmModal:!1},rooms:[],roomId:"",textConfirm:""}},methods:{manageTeam:function(e){this.$router.push({name:"TeamSettings",params:{roomId:e.roomId,roomName:e.roomName}})},leaveTeam:function(e){if(e.host===this.uid)this.roomId=e.roomId,this.modalList.showingHandOverModal=!0;else{var t={roomId:e.roomId,uid:this.uid};this.$http.post("/api/firebase/leaveTeam",t)}},deleteTeam:function(e){e.host===this.uid&&(this.modalList.showingConfirmModal=!0,this.roomId=e.roomId)},confirm:function(){if("확인"===this.textConfirm){this.closeModal("showingConfirmModal");var e={roomId:this.roomId,uid:this.uid};this.$http.post("/api/firebase/deleteTeam",e)}},closeModal:function(e){this.modalList[e]=!1,this.textConfirm=""}},created:function(){var e=this;console.log("uid = ",this.uid),this.$firebase.database().ref("/users/".concat(this.uid,"/favRooms/")).on("value",(function(t){e.rooms=[],t.forEach((function(t){var o=t.val().roomDetail;o.roomId=t.key,e.rooms.push(o)}))}))}},q=F,J=(o("ce52"),Object(d["a"])(q,w,y,!1,null,null,null)),z=J.exports,G=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("header",{staticClass:"header"},[o("h3",{staticClass:"text-center"},[e._v(" "+e._s(e.roomName)+" "),o("a",{on:{click:e.leaveRoom}},[o("i",{staticClass:"fa fa-long-arrow-left fa-2x",attrs:{"aria-hidden":"true"}})])])]),o("div",{staticClass:"webRTC"},[o("WebRTC")],1),o("div",{staticClass:"chat"},[o("chat")],1),o("div",{staticClass:"user-list"},[o("userList")],1),o("nav",{staticClass:"footer"},[o("ul",{staticClass:"menu"},[o("li",{staticClass:"menu-item",on:{click:function(t){return t.preventDefault(),e.controlModal("showingInviteModal")}}},[o("a",{staticClass:"menu-link",attrs:{href:"#"}},[e._v("Invite")])]),o("li",{staticClass:"menu-item",on:{click:function(e){e.preventDefault()}}},[o("a",{staticClass:"menu-link",attrs:{href:"#"}},[e._v("Room Settings")])])])]),o("inviteModal",{staticClass:"invite-modal",attrs:{showModal:e.modalList.showingInviteModal},on:{closemodal:function(t){return e.controlModal("showingInviteModal")}}})],1)},K=[],Q=o("5530"),X=o("2f62"),Y=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{ref:"msg",staticClass:"msg"},[o("ul",{staticClass:"msg-container"},[e._l(e.messages,(function(t){return o("li",{key:t.key,staticClass:"msg-history"},["bot"===t.sender?o("div",{staticClass:"bot-msg"},[o("p",[e._v(e._s(t.sentAt))]),o("p",[e._v(e._s(t.message))])]):o("div",[t.sender===e.user.displayName?o("div",[o("div",{staticClass:"sent-msg"},[o("div",{staticClass:"sent-msg-info"},[o("p",[e._v(e._s(t.sentAt))])]),o("div",{staticClass:"sent-msg-text"},[o("p",[e._v(e._s(t.message))])])])]):o("div",[o("div",{staticClass:"received-msg"},[o("div",{staticClass:"received-msg-info"},[o("img",{staticClass:"received-msg-img",attrs:{src:"https://ptetutorials.com/images/user-profile.png",alt:"sunil"}}),o("p",{staticClass:"sender"},[e._v(e._s(t.sender))]),o("p",{staticClass:"received-msg-sentAt"},[e._v(e._s(t.sentAt))])]),o("div",{staticClass:"received-msg-text"},[o("p",[e._v(e._s(t.message))])])])])])])})),o("div",{staticClass:"type-msg"},[o("div",{staticClass:"input-msg-write"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"write-msg",attrs:{type:"text",placeholder:"Type a message"},domProps:{value:e.message},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage(t)},input:function(t){t.target.composing||(e.message=t.target.value)}}})])])],2)])},Z=[],ee={name:"chat",data:function(){return{user:{email:this.$user.email,uid:this.$user.uid,displayName:this.$user.displayName},roomId:this.$route.params.roomId,data:{type:"",uid:"",message:""},message:null,messages:[]}},methods:{sendMessage:function(){var e={roomId:this.roomId,displayName:this.user.displayName,message:this.message};this.$http.post("/api/firebase/message/",e),this.message=null},fetchMessages:function(){var e=this;this.$firebase.database().ref("/messageHub/".concat(this.roomId,"/messages")).on("value",(function(t){e.messages=[],t.forEach((function(t){var o=t.val();o.key=t.key;var s=new Date(o.sentAt);o.sentAt=s.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"}),e.messages.push(o)}))}))},scrollToEnd:function(){var e=this.$el.getElementsByClassName("msg-container")[0];e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}},created:function(){this.fetchMessages()},mounted:function(){this.scrollToEnd()},updated:function(){var e=this;this.$nextTick((function(){return e.scrollToEnd()}))}},te=ee,oe=(o("6b64"),Object(d["a"])(te,Y,Z,!1,null,null,null)),se=oe.exports,ne=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"webRTC"},[o("div",[o("span",{staticClass:"mute-video-button",on:{click:function(t){return t.preventDefault(),e.muteVideo(t)}}},[e.isVideoMuted?e._e():o("i",{staticClass:"fa fa-video-camera fa-2x",attrs:{"aria-hidden":"true"}}),e.isVideoMuted?o("i",{staticClass:"fa fa-pause fa-2x",attrs:{"aria-hidden":"true"}}):e._e()]),o("span",{staticClass:"mute-audio-button",on:{click:function(t){return t.preventDefault(),e.muteAudio(t)}}},[e.isAudioMuted?e._e():o("i",{staticClass:"fa fa-microphone fa-2x",attrs:{"aria-hidden":"true"}}),e.isAudioMuted?o("i",{staticClass:"fa fa-microphone-slash fa-2x",attrs:{"aria-hidden":"true"}}):e._e()])]),o("div",[o("video",{ref:"localVideo",attrs:{autoplay:"",muted:"",playsinline:""},domProps:{muted:!0}}),o("p",[e._v("Me")])]),o("div",{ref:"videos",staticClass:"remote-streams"})])},ae=[],ie={name:"WebRTC",data:function(){return{isVideoMuted:!0,isAudioMuted:!0}},methods:Object(Q["a"])({muteVideo:function(){this.isVideoMuted=!this.isVideoMuted,this.MuteVideo()},muteAudio:function(){this.isAudioMuted=!this.isAudioMuted,this.MuteAudio()}},Object(X["b"])("webRTC",["SetUser","LocalVideoSetter","VideoSetter","MuteVideo","MuteAudio"])),mounted:function(){this.SetUser(this.$user),this.LocalVideoSetter(this.$refs.localVideo),this.VideoSetter(this.$refs.videos)}},re=ie,le=(o("b79a"),Object(d["a"])(re,ne,ae,!1,null,null,null)),ce=le.exports,ue=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"user-list"},[e._v(" Total User "),o("ul",e._l(e.totalUser,(function(t){return o("li",{key:t.uid},[e._v(" "+e._s(t.userName)+" ")])})),0),o("br"),e._v(" Online "),o("ul",e._l(e.logInUser,(function(t){return o("li",{key:t.uid},[o("p",{on:{contextmenu:function(o){return o.preventDefault(),e.$refs.menu.open(o,t)}}},[e._v(" "+e._s(t.displayName)+" ")])])})),0)]),o("vue-context",{ref:"menu",scopedSlots:e._u([{key:"default",fn:function(t){return[o("li",[o("a",{on:{click:function(o){return o.preventDefault(),e.connect(t.data)}}},[e._v("연결 하기")])]),o("li",[o("a",{on:{click:function(o){return o.preventDefault(),e.disconnect(t.data)}}},[e._v("연결 해제 하기")])])]}}])})],1)},de=[],me={name:"USERLIST",components:{VueContext:M["a"]},data:function(){return{roomId:this.$route.params.roomId,logInUser:[],totalUser:[]}},methods:Object(Q["a"])({connect:function(e){console.log("connect with ",e),this.ConnectWithTheUser(e)},disconnect:function(e){console.log("disconnect with ",e),this.DisconnectWithTheUser(e)}},Object(X["b"])("webRTC",["ConnectWithTheUser","DisconnectWithTheUser"])),created:function(){var e=this;this.$firebase.database().ref("/rooms/".concat(this.roomId,"/userlist")).on("value",(function(t){var o=[];t.forEach((function(e){o.push(e.val())})),e.totalUser=o})),this.$firebase.database().ref("/rooms/".concat(this.roomId,"/userOnline")).on("value",(function(t){var o=[];t.forEach((function(e){o.push(e.val())})),e.logInUser=o}))}},fe=me,pe=Object(d["a"])(fe,ue,de,!1,null,null,null),he=pe.exports,ve=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"modal-wrapper",on:{click:function(t){return e.$emit("closemodal")}}},[e.showModal?o("smallModal",{on:{close:e.showModal}},[o("h3",{attrs:{slot:"header"},slot:"header"},[e._v("Copy this roomId and give it to your student")]),o("h4",{attrs:{slot:"body"},slot:"body"},[e._v(e._s(this.$route.params.roomId))]),o("h4",{attrs:{slot:"footer"},slot:"footer"},[o("i",{staticClass:"fa fa-times closeModalBtn fa-2x",attrs:{"aria-hidden":"true"},on:{click:function(t){return e.$emit("closemodal")}}})])]):e._e()],1)},ge=[],Ce={components:{smallModal:V},props:["showModal"]},be=Ce,_e=Object(d["a"])(be,ve,ge,!1,null,null,null),Ie=_e.exports,we={name:"room",components:{chat:se,WebRTC:ce,userList:he,inviteModal:Ie},data:function(){return{roomId:this.$route.params.roomId,roomName:this.$route.params.roomName,user:{email:this.$user.email,uid:this.$user.uid,displayName:this.$user.displayName},logInUser:[],totalUser:[],logInUserModal:{},modalList:{showingInviteModal:!1}}},methods:Object(Q["a"])({enterRoom:function(){console.log("vue에서 roomId",this.roomId),this.EnterRoom({roomName:this.roomName,roomId:this.roomId})},leaveRoom:function(){this.$router.go(-1),console.log("vue에서 roomId",this.roomId),this.LeaveRoom({roomName:this.roomName,roomId:this.roomId})},controlModal:function(e){this.modalList[e]=!this.modalList[e]}},Object(X["b"])("webRTC",["EnterRoom","LeaveRoom"])),mounted:function(){this.enterRoom()}},ye=we,Me=(o("5ca1"),Object(d["a"])(ye,G,K,!1,null,null,null)),ke=Me.exports,$e=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("h2",[e._v(" Add Room "),o("a",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("(back)")])]),o("form",{on:{submit:function(t){return t.preventDefault(),e.createRoom(t)}}},[o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.roomNameCreate,expression:"roomNameCreate",modifiers:{trim:!0}}],attrs:{placeholder:"Enter Room Name"},domProps:{value:e.roomNameCreate},on:{input:function(t){t.target.composing||(e.roomNameCreate=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("button",{attrs:{type:"submit",variant:"primary",disabled:!e.roomNameCreate}},[e._v(" Create Room ")])]),o("form",{on:{submit:function(t){return t.preventDefault(),e.addFavRoom(t)}}},[o("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.roomCodeAdd,expression:"roomCodeAdd",modifiers:{trim:!0}}],attrs:{placeholder:"Enter Room code"},domProps:{value:e.roomCodeAdd},on:{input:function(t){t.target.composing||(e.roomCodeAdd=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),o("button",{attrs:{type:"submit",variant:"primary",disabled:!e.roomCodeAdd}},[e._v(" Add Room ")])])])},xe=[],Ne={name:"AddBoard",data:function(){return{roomNameCreate:"",roomCodeAdd:""}},methods:{createRoom:function(){var e={roomName:this.roomNameCreate,userName:this.$user.displayName,host:this.$user.uid};this.$http.post("/api/firebase/createRoom",e),this.$router.go(-1)},addFavRoom:function(){var e={uid:this.$user.uid,userName:this.$user.displayName,roomId:this.roomCodeAdd};this.$http.post("/api/firebase/addFavRoom",e),this.$router.go(-1)}}},Ue=Ne,Re=Object(d["a"])(Ue,$e,xe,!1,null,null,null),Te=Re.exports,Oe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("p",{on:{click:function(t){return e.$router.go(-1)}}},[o("i",{staticClass:"fa fa-long-arrow-left fa-2x",attrs:{"aria-hidden":"true"}})]),e._v(" "+e._s(e.roomName)+", "+e._s(e.roomId)+" ")])},Le=[],Ee={name:"TeamSettings",data:function(){return{roomId:this.$route.params.roomId,roomName:this.$route.params.roomName}}},Se=Ee,je=Object(d["a"])(Se,Oe,Le,!1,null,null,null),Ae=je.exports;s["a"].use(h["a"]);var De,Ve,Pe,We,He,Be=[{path:"/",name:"Login",component:I},{path:"/roomList",name:"RoomList",component:z},{path:"/room/:roomId/:roomName",name:"Room",component:ke},{path:"/add-room",name:"AddRoom",component:Te},{path:"/team-settings/:roomId/:roomName",name:"TeamSettings",component:Ae},{path:"/about",name:"About",component:function(){return o.e("about").then(o.bind(null,"f820"))}}],Fe=new h["a"]({mode:"history",base:"/",routes:Be}),qe=Fe,Je={email:""},ze={storedNickName:function(e){return e.email}},Ge={logIn:function(e,t,o){e.email=t+o,qe.push({name:"RoomList",params:{nickname:t}})},signUp:function(e,t,o){console.log("signup method"),console.log(e,t,o);var s={email:e,password:t,displayName:o};a.a.post("/api/firebase/signup",s)}},Ke={LogIn:function(e,t,o){var s=e.commit;s("logIn",t,o)},SignUp:function(e,t,o,s){var n=e.commit;console.log("actions",t,o,s),n("signUp",t,o,s)}},Qe={namespaced:!0,state:Je,getters:ze,mutations:Ge,actions:Ke},Xe=(o("99af"),o("caad"),o("d81d"),o("45fc"),o("b64b"),o("2532"),o("b85c")),Ye=io("13.125.214.253:3000",{autoConnect:!0}).connect(),Ze={video:{height:240,width:420},audio:{echoCancellation:!0}},et={iceServers:[{urls:"stun:swm183.com:3478"},{urls:"turn:swm183.com:3478",username:"Oh",credential:"test"}],iceCandidatePoolSize:10},tt=!1,ot=!1,st={},nt={},at={},it=!0,rt=!0,lt={room:"",localVideo:"",videos:"",user:{},userOnline:[]},ct={storedRoom:function(e){return e.room}},ut={setUser:function(e,t){e.user=t,e.userOnline.push(t),Pe={user:t,sessionId:Ve}},enterRoom:function(e,t){e.room=t.roomName,We=t.roomName,Ye.emit("create or join",t.roomName,e.user,t.roomId),console.log("".concat(t.roomName,"을 생성 또는 ").concat(t.roomName,"에 참가")),He=setInterval((function(){return Ye.emit("ImOnline",e.room)}),2e3)},leaveRoom:function(e,t){console.log("js에서 roomId",t.roomId),Ye.emit("leave room",t.roomName,t.roomId),console.log("".concat(t.roomName,"을 떠남")),It()},connectWithTheUser:function(e,t){"connected"===st[t.sessionId].connectionState?alert("you are already connected with ".concat(t.displayName)):pt(t.sessionId,!0)},disconnectWithTheUser:function(e,t){"connected"===st[t.sessionId].connectionState&&(st[t.sessionId].close(),Ct(t.sessionId),Ye.emit("disconnectRequest",Pe.sessionId,t.sessionId),pt(t.sessionId))},localVideoSetter:function(e,t){e.localVideo=t},videoSetter:function(e,t){e.videos=t}},dt={SetUser:function(e,t){var o=e.commit;o("setUser",t)},EnterRoom:function(e,t){return Object(x["a"])(regeneratorRuntime.mark((function o(){var s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return s=e.commit,o.prev=1,o.next=4,navigator.mediaDevices.getUserMedia(Ze);case 4:De=o.sent,lt.localVideo.srcObject=De,De.getTracks()[0].enabled=!1,De.getTracks()[1].enabled=!1,o.next=13;break;case 10:o.prev=10,o.t0=o["catch"](1),console.log("navigator.getUserMedia error: ",o.t0);case 13:s("enterRoom",t);case 14:case"end":return o.stop()}}),o,null,[[1,10]])})))()},LeaveRoom:function(e,t){var o=e.commit;o("leaveRoom",t)},ConnectWithTheUser:function(e,t){var o=e.commit;console.log("ConnectWithTheUser - userInfo = ",t),o("connectWithTheUser",t)},DisconnectWithTheUser:function(e,t){var o=e.commit;console.log("ConnectWithTheUser - userInfo = ",t),o("disconnectWithTheUser",t)},LocalVideoSetter:function(e,t){var o=e.commit;o("localVideoSetter",t)},VideoSetter:function(e,t){var o=e.commit;o("videoSetter",t)},MuteVideo:function(){bt()},MuteAudio:function(){_t()}};function mt(e){Ye.emit("message",e)}function ft(){console.log("roomName=",We),console.log("connected Users =",st);var e=Object.keys(st);e.map((function(e){return pt(e,!0),e}))}function pt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];st[e]=new RTCPeerConnection(et),nt[e]=new MediaStream,at[e]=!1,ht(e,t)}function ht(e,t){st[e].addEventListener("icecandidate",(function(t){t.candidate?mt({type:"candidate",label:t.candidate.sdpMLineIndex,id:t.candidate.sdpMid,candidate:t.candidate.candidate,sendTo:e,userInfo:Pe,room:We}):console.log("End of candidates.")})),st[e].addEventListener("iceconnectionstatechange",(function(){st[e]&&"failed"===st[e].iceConnectionState&&(console.log("restartICE"),st[e].restartIce())})),st[e].ontrack=function(t){if(console.log("비디오가 추가될 때, evnet = ",t),console.log("비디오가 추가될 때, evnet.streams = ",t.streams),t){var o=lt.videos.childNodes,s=!1;if(o.forEach((function(t){t.id===e&&(s=!0)})),!s){console.log("childVideos = ",o),console.log("Remote stream added.",t.streams[0]),nt[e]=t.streams[0];var n=document.createElement("div");n.id=e;var a,i=document.createElement("video");i.srcObject=nt[e],i.autoplay=!0,i.playsinline=!0,i.userId=e,n.appendChild(i),console.log("state.userOnline = ",lt.userOnline),lt.userOnline.some((function(t){return t.sessionId===e&&(console.log(t.user.displayName),a=t.user.displayName,!0)}));var r=document.createElement("p");r.innerHTML=a,n.appendChild(r),lt.videos.appendChild(n)}}},t&&st[e].addEventListener("negotiationneeded",Object(x["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,console.log("offering sdp"),t.next=4,st[e].createOffer();case 4:o=t.sent,st[e].setLocalDescription(o),mt({type:"offer",sendTo:e,userInfo:Pe,sdp:o,room:We}),console.log("offer created for a user: ",st[e]),ot=!0,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.error("Failed to create pc session description",t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))),void 0===De||at[e]||(console.log(e,"에 track을 추가하는 중."),De.getTracks().forEach((function(t){st[e].addTrack(t,De)})),at[e]=!0)}function vt(e){return gt.apply(this,arguments)}function gt(){return gt=Object(x["a"])(regeneratorRuntime.mark((function e(t){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,console.log("make answer to: ",t),e.next=4,st[t].createAnswer();case 4:o=e.sent,st[t].setLocalDescription(o),console.log("makeAnswer ",o),mt({type:"answer",sendTo:t,userInfo:Pe,sdp:o,room:We}),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),console.trace("Failed to create session description: ".concat(e.t0.toString()));case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),gt.apply(this,arguments)}function Ct(e){var t,o=lt.videos.childNodes,s=Object(Xe["a"])(o);try{for(s.s();!(t=s.n()).done;){var n=t.value;if(n.id===e){lt.videos.removeChild(n);break}}}catch(a){s.e(a)}finally{s.f()}}function bt(){De.getTracks()[1].enabled=!!it,it=!it}function _t(){De.getTracks()[0].enabled=!!rt,rt=!rt}function It(){De.getTracks().forEach((function(e){"live"===e.readyState&&e.stop()})),clearInterval(He),wt()}function wt(){tt=!1,ot=!1,st={},nt={},at={},De=null,We=null,it=!0,rt=!0;while(lt.videos.lastElementChild)lt.videos.removeChild(lt.videos.lastElementChild);lt.room=null,lt.localVideo=null,lt.videos=null,lt.userOnline=[]}Ye.on("created",(function(e,t){console.log("방 생성 시, state.userList의 상태",t),console.log("방 생성 시, userInfo의 상태",Pe),console.log("created ".concat(e)),ot=!0,tt=!0})),Ye.on("joined",(function(e,t,o){console.log("".concat(t," joined ").concat(e)),console.log("userList",o.sockets),console.log("socketId === sessionId",t===Pe.sessionId),ot?pt(t):(st=Object(Q["a"])({},o.sockets),console.log("방에 들어온 유저의 connectedUsers before delete = ",st),delete st[Pe.sessionId],console.log("방에 들어온 유저의 connectedUsers after delete = ",st),nt=Object(Q["a"])({},o.sockets),delete nt[Pe.sessionId],at=Object(Q["a"])({},o.sockets),tt=!0,console.log("creating peer connection"),ft())})),Ye.on("sessionID",(function(e){Ve=e})),Ye.on("disconnectRequest",(function(e){Ct(e),pt(e)})),Ye.on("userDisconnected",(function(e,t){Ct(t),st[t].close()})),Ye.on("noSignal",(function(e){ut.leaveRoom({},e),alert("연결이 끊겼습니다. 방을 나갔다 다시 들어와주세요.")})),Ye.on("message",(function(e){if(console.log("message =",e),"offer"===e.type)console.log("got offer from =",e.userInfo.sessionId),console.log("connectedUsers의 상태는? ",st[e.userInfo.sessionId]),console.log("connectedUsers는? ",st),console.log("got offer connectedUsers[message.userInfo.sessionId] =",st[e.userInfo.sessionId]),lt.userOnline.includes(e.userInfo)||lt.userOnline.push(e.userInfo),st[e.userInfo.sessionId].setRemoteDescription(new RTCSessionDescription(e.sdp)),console.log("answer 만드는 중"),vt(e.userInfo.sessionId);else if("answer"===e.type&&tt)console.log("got answer from: ",e.userInfo.sessionId),lt.userOnline.includes(e.userInfo)||lt.userOnline.push(e.userInfo),st[e.userInfo.sessionId].setRemoteDescription(new RTCSessionDescription(e.sdp));else if("candidate"===e.type&&tt){console.log("got candidate from: ",e.userInfo.sessionId);var t=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});st[e.userInfo.sessionId].addIceCandidate(t)}}));var yt={namespaced:!0,state:lt,getters:ct,mutations:ut,actions:dt};s["a"].use(X["a"]);var Mt=new X["a"].Store({modules:{room:Qe,webRTC:yt}});s["a"].config.productionTip=!1,s["a"].prototype.$http=a.a;var kt=xt(),$t={params:kt};function xt(){for(var e="",t=0;t<16;t+=1){var o=Math.floor(58*Math.random()+65),s=String.fromCharCode(o);e+=s}return e}console.log($t),a.a.get("/api/firebase",$t).then((function(e){console.log(e.data);var t=r.a.AES.decrypt(e.data,kt),o=JSON.parse(t.toString(r.a.enc.Utf8));console.log(o),l["initializeApp"](o),s["a"].prototype.$firebase=l,s["a"].prototype.$auth=l["auth"](),s["a"].prototype.$setUser=function(e){s["a"].prototype.$user=e}})),new s["a"]({router:qe,store:Mt,render:function(e){return e(p)}}).$mount("#app")},"5c0b":function(e,t,o){"use strict";var s=o("9c0c"),n=o.n(s);n.a},"5ca1":function(e,t,o){"use strict";var s=o("f255"),n=o.n(s);n.a},6:function(e,t){},"6b64":function(e,t,o){"use strict";var s=o("f0e3"),n=o.n(s);n.a},7:function(e,t){},8:function(e,t){},9:function(e,t){},"9c0c":function(e,t,o){},ae1e:function(e,t,o){},b79a:function(e,t,o){"use strict";var s=o("322e"),n=o.n(s);n.a},ce52:function(e,t,o){"use strict";var s=o("2c86"),n=o.n(s);n.a},d176:function(e,t,o){"use strict";var s=o("20fc"),n=o.n(s);n.a},d6db:function(e,t,o){"use strict";var s=o("e67a"),n=o.n(s);n.a},e67a:function(e,t,o){},f0e3:function(e,t,o){},f255:function(e,t,o){}});
//# sourceMappingURL=app.90d6de45.js.map